perl <- "C:\Strawberry\perl\bin\perl5.22.1.exe"
BAS <- read.xls("C:/Users/meerim/Documents/Hertie 2015/Master thesis/SBS data/BAS evaluated projects_stata.xls", perl=perl)
perl <- "C:/Strawberry/perl/bin/perl5.22.1.exe"
BAS <- read.xls("C:/Users/meerim/Documents/Hertie 2015/Master thesis/SBS data/BAS evaluated projects_stata.xls", perl=perl)
View(BAS)
names(BAS)
M1 <- lm(Adjturnover1 ~ BAS.grant.., data=BAS)
kable(M1)
library(knitr)
type = 'response')
kable(M1)
summary M1
summary (M1)
M1 <- glm(Adjturnover1 ~ BAS.grant.., data=BAS)
data(BAS)
M1 <- glm(Adjturnover1 ~ BAS.grant.., data=BAS)
data(BAS)
M1 <- lm(Adjturnover1 ~ BAS.grant.., data=BAS)
summary (BAS)
View(BAS)
M1 <- lm(Adjturnover1 ~ Adj..BAS.cost, data=BAS)
M1 <- lm(Adjturnover1 ~ Adj..BAS.cost + Employee1, data=BAS)
M1 <- lm(Adjturnover1 ~ Employee1, data=BAS)
M1 <- glm(Adjturnover1 ~ Employee1, data=BAS, family="binomial")
kable(M1)
fitted$predicted <- glm(Adjturnover1 ~ Employee1, data=BAS, family="binomial")
kable(M1)
fitted$predicted <- predict(M1, newdata=fitted, type="response")
kable(fitted)
fitted$predicted <- predict(M1, newdata=fitted, type="response")
stargazer::stargazer(M1, title = 'Logistic Regression Estimates of Grad School Acceptance',
digits = 2, type = 'html')
stargazer::stargazer(M1, title = 'Logistic Regression Estimates of Grad School Acceptance',
digits = 2, type = 'pdf')
stargazer::stargazer(M1, title = 'Logistic Regression Estimates of Grad School Acceptance',
digits = 2, type = 'latex')
install.packages('utils')
install.packages("utils")
install.packages("utils")
install.packages("utils")
install.packages("utils")
mydestfile <- 'C:\Users\meerim\Links\Downloads.lnk'
mydestfile <- "C:\Users\meerim\Links\Downloads.lnk"
mydestfile <- "C:/Users/meerim/Links/Downloads.lnk"
URL2 <- 'http://de.statista.com/statistik/daten/studie/255815/umfrage/kohlendioxid-emissionen-je-einwohner-in-berlin/'
download.file(URL2, mydestfile, mode="wb")
mydestfile <- "C:/Users/meerim/Links/Downloads"
URL2 <- 'http://de.statista.com/statistik/daten/studie/255815/umfrage/kohlendioxid-emissionen-je-einwohner-in-berlin/'
download.file(URL2, mydestfile, mode="wb")
mydestfile <- "C:/Users/meerim/Documents"
library(rvest)
URL2 <- 'http://de.statista.com/statistik/daten/studie/255815/umfrage/kohlendioxid-emissionen-je-einwohner-in-berlin/'
download.file(URL2, mydestfile, mode="wb")
mydestfile <- "C:\Users\meerim\Documents\R"
URL2 <- 'http://de.statista.com/statistik/daten/studie/255815/umfrage/kohlendioxid-emissionen-je-einwohner-in-berlin/'
download.file(URL2, mydestfile, mode="wb")
library(repmis)
install.packages('repmis')
source_XlsxData(URL2, sheet1, sha1=NULL, cache=FALSE, clearCache=FALSE, read.xls)
library(rvest)
library(dplyr)
library(repmis)
URL2 <- 'http://de.statista.com/statistik/daten/studie/255815/umfrage/kohlendioxid-emissionen-je-einwohner-in-berlin/'
source_XlsxData(URL2, sheet1, sha1=NULL, cache=FALSE, clearCache=FALSE)
library(repmis)
library(rJava)
library(xlsx)
library(xlsxjars)
library(plyr)
library(gdata)
library(rJava)
library(xlsxjars)
library(xlsx)
library(plyr)
library(gdata)
setwd("C:\\Users\\meerim\\Desktop\\emissions")
filenames <- list.files(pattern=".xlsx")
df.list <- lapply(filenames, function(x) read.xlsx(file=x, sheetName="Daten", startRow = 6,
colIndex=2:3,as.data.frame=TRUE, header=FALSE, FILENAMEVAR=x))
ls()
write.xlsx(mydata, "c:/mydata.xlsx")
write.xlsx(mydata, "C:\\Users\\meerim\\Desktop\\emissions")
write.xlsx(df.list, "C:\\Users\\meerim\\Desktop\\emissions")
df.list
class9df.list)
class(df.list)
list.files()
library(plyr)
file_list <- list.files(pattern=".xlsx")
for (file in file_list){
# if the merged dataset doesn't exist, create it
if (!exists("dataset")){
dataset <- read.table(file, header=TRUE, sep="\t")
}
# if the merged dataset does exist, append to it
if (exists("dataset")){
temp_dataset <-read.table(file, header=TRUE, sep="\t")
dataset<-rbind(dataset, temp_dataset)
rm(temp_dataset)
}
}
list.files()
warnings()
dataset
read.xlsx2(filenames[2], sheetIndex=1, startRow=6)
read.xlsx2(filenames[2], sheetIndex=1, startRow=3)
read.xlsx2(filenames[2], sheetIndex=2, startRow=6)
read.xlsx2(filenames[2], sheetIndex=2, startRow=6, header=TRUE)
read.xlsx2(filenames[2], sheetIndex=2, startRow=6, header=TRUE)
data <- read.xlsx2(filenames[2], sheetIndex=2, startRow=6, colnames<-(c("Year", "Emissions")))
data <- read.xlsx2(filenames[2], sheetIndex=2, startRow=6, `colnames<-` (c("Year", "Emissions")))
data <- read.xlsx2(filenames[2], sheetIndex=2, startRow=6, colnames <- c("Year", "Emissions"))
data <- read.xlsx2(filenames[3], sheetIndex=2, startRow=6, colnames <- c("Year", "Emissions"))
data <- read.xlsx2(filenames[3], sheetIndex=2, startRow=6)
View(data)
data <- read.xlsx2(filenames[3], sheetIndex=2, startRow=6, header=FALSE)
View(data)
colnames(data) <- c("Year", "Emissions")
View(data)
data$Bundesland <- "Hamburg"
View(data)
data$Bundesland <- paste=(read.xlsx2(filenames[3],sheetIndex=2,rowIndex=3:3,
colIndex=2:2))
data$Bundesland <- paste=(read.xlsx2(filenames[3],sheetIndex=2,rowIndex=3:3,
colIndex=2:2), header=FALSE)
data$Bundesland <- paste=(read.xlsx2(filenames[3],sheetIndex=2,rowIndex=3:3,
colIndex=2:2, header=FALSE))
data$Bundesland <- paste(read.xlsx2(filenames[3],sheetIndex=2,rowIndex=3:3,
colIndex=2:2, header=FALSE))
test <- read.xlsx2(filenames[3],sheetIndex=2,rowIndex=3:3,
colIndex=2:2, header=FALSE)
View(test)
test <- read.xlsx2(filenames[3], CellBlock(sheetIndex=2, 3, 2), header=FALSE)
test <- read.xlsx2(filenames[3], CellBlock(sheet='Daten', 3, 2), header=FALSE)
test <- read.xlsx2(filenames[3], CellBlock(sheet='Daten', 3, 2, norows), header=FALSE)
test <- read.xlsx2(filenames[3], sheetIndex=2, rowIndex = 3:4, colIndex = 2:3, header=FALSE)
View(test)
test <- read.xlsx2(filenames[3], sheetIndex=2, startRow=3, endRow=3, header=FALSE)
View(test)
bundesland <- read.xlsx2(filenames[3], sheetIndex=2, startRow=3, endRow=3, header=FALSE)
data$Bundesland <- paste(bundesland)
View(data)
data$Bundesland <- paste("bundesland")
View(data)
data$Bundesland <- paste(read.xlsx2
(filenames[3], sheetIndex=2, startRow=3, endRow=3, header=FALSE))
View(data)
data$Bundesland <- paste(read.xlsx
(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE))
View(data)
read.xlsx
(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE))
test <- read.xlsx(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
View(test)
data$Bundesland <- paste(test[1,1])
View(data)
data$Bundesland %>% paste(test[1,1])
View(data)
filenames <- list.files(pattern=".xlsx")
for (file in filenames){
data <- read.xlsx2(file, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(file, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
}
for (filename in filenames){
data <- read.xlsx2(filename, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(filename, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
}
df.list <- lapply(filenames, function(x) read.xlsx(file=x, sheetName="Daten", startRow = 6,
colIndex=2:3,as.data.frame=TRUE, header=FALSE, FILENAMEVAR=x))
for (filename in filenames){
data <- read.xlsx2(filename, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(filename, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
}
df.list <- lapply(filenames, function(x) read.xlsx(file=x, sheetName="Daten", startRow = 6,
colIndex=2:3,as.data.frame=TRUE, header=FALSE, FILENAMEVAR=x))
setwd("C:\\Users\\meerim\\Desktop\\emissions")
filenames <- list.files(pattern=".xlsx")
df.list <- lapply(filenames, function(x) read.xlsx(file=x, sheetName="Daten", startRow = 6,
colIndex=2:3,as.data.frame=TRUE, header=FALSE, FILENAMEVAR=x))
for (i in df.list){
data <- read.xlsx2(i, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
}
for (i in df.list){
read.xlsx2(i, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
}
i
setwd("C:\\Users\\meerim\\Desktop\\emissions")
filenames <- list.files(pattern=".xlsx")
data <- lapply(filenames, function(x) read.xlsx2(file=x, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1])) #create a new column with same values for all rows
data <- lapply(filenames, function(x) read.xlsx2(file=x, sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]
data <- lapply(filenames, function(x) read.xlsx2(file=x, sheetIndex=2, startRow=6, header=FALSE),
colnames(data) <- c("Year", "Emissions", "Bundesland"),
data$Bundesland <- paste(read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)) #create a new column with same values for all rows
setwd("C:\\Users\\meerim\\Desktop\\emissions")
filenames <- list.files(pattern=".xlsx")
data <- lapply(filenames, function(x) read.xlsx2(file=x, sheetIndex=2, startRow=6, header=FALSE),
colnames(data) <- c("Year", "Emissions", "Bundesland"),
data$Bundesland <- paste(read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)) #create a new column with same values for all rows
data <- lapply(filenames, function(x) read.xlsx2(file=x, sheetIndex=2, startRow=6, header=FALSE),
colnames(data) <- c("Year", "Emissions", "Bundesland"),
data$Bundesland <- paste(read.xlsx(file, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)) #create a new column with same values for all rows
data <- lapply(filenames, function(x) read.xlsx2(file=x, sheetIndex=2, startRow=6, header=FALSE)
filenames <- list.files(pattern=".xlsx")
data <- read.xlsx2(filenames[3], sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
fun <- function(x) {
df <- read.xlsx(x, sheetIndex=2, startRow=6, header=FALSE)
colnames(df) <- c("Year", "Emissions")
test <- read.xlsx(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1])
}
df
setwd("C:\\Users\\meerim\\Desktop\\emissions")
library(rJava)
library(xlsxjars)
library(xlsx)
library(plyr)
library(gdata)
setwd("C:\\Users\\meerim\\Desktop\\emissions")
filenames <- list.files(pattern=".xlsx")
fun <- function(x) {
df <- read.xlsx(x, sheetIndex=2, startRow=6, header=FALSE)
colnames(df) <- c("Year", "Emissions")
test <- read.xlsx(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1])
}
df.big <- ldply(filenames, fun)
df.big
library(rJava)
library(xlsxjars)
library(xlsx)
library(plyr)
library(gdata)
setwd("C:\\Users\\meerim\\Desktop\\emissions")
filenames <- list.files(pattern=".xlsx")
fun <- function(x) {
df <- read.xlsx(x, sheetIndex=2, startRow=6, header=FALSE)
colnames(df) <- c("Year", "Emissions")
test <- read.xlsx(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1])
}
df.big <- ldply(filenames, fun)
fun <- function(x) {
df <- read.xlsx(file=x, sheetIndex=2, startRow=6, header=FALSE)
colnames(df) <- c("Year", "Emissions")
test <- read.xlsx(file=x, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
df$Bundesland <- paste(test[1,1])
}
df.big <- ldply(filenames, fun)
data <- read.xlsx2(filenames[3], sheetIndex=2, startRow=6, header=FALSE)
colnames(data) <- c("Year", "Emissions")
test <- read.xlsx(filenames[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
data$Bundesland <- paste(test[1,1]) #create a new column with same values for all rows
data
setwd("C:\\Users\\meerim\\Desktop\\emissions")
all_files <- list.files(pattern=".xlsx")
getwd()
library(rio)        # tool for exporting to csv (can also do excel)
library(tidyr)      # tool for reshaping, though not actually done here
all_files <- list.files(pattern=".xlsx")
all_subbed <- NULL
for (i in all_files) {
message(i)
if (grepl(pattern = '.xls', x = i)) {
message('Skipped')
}
else if (grepl(pattern = 'xlsx', x = i)) {
temp_all <- read.xlsx(i, sheetIndex=2, header=FALSE)
temp_data <- read.xlsx(i, sheetIndex=2, startRow=6, header=FALSE)
# Extract specific cell for the name of the state
temp_bundesland <- read.xlsx(all_files[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
names(temp_data) <- c('Year', 'Emissions')
temp_data$State <- paste(temp_bundesland[1,1])
# Bind individual project to main data frame
all_subbed <- rbind(all_subbed, temp_data)
}
}
for (i in all_files) {
message(i)
if (grepl(pattern = '.xls$', x = i)) {
message('Skipped')
}
else if (grepl(pattern = '.xlsx', x = i)) {
# Load individual document in to R as a list
temp_all <- read.xlsx(i, sheetIndex=2, header=FALSE)
temp_data <- read.xlsx(i, sheetIndex=2, startRow=6, header=FALSE)
# Extract specific cell for the name of the state
temp_bundesland <- read.xlsx(all_files[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
names(temp_data) <- c('Year', 'Emissions')
temp_data$State <- paste(temp_bundesland[1,1])
# Bind individual project to main data frame
all_subbed <- rbind(all_subbed, temp_data)
}
}
library(rJava)
library(xlsxjars)
library(xlsx)
library(plyr)
library(gdata)
library(rio)        # tool for exporting to csv (can also do excel)
library(tidyr)      # tool for reshaping, though not actually done here
setwd("C:\\Users\\meerim\\Desktop\\emissions")
all_files <- list.files(pattern=".xlsx")
all_subbed <- NULL
for (i in all_files) {
message(i)
if (grepl(pattern = '.xls$', x = i)) {
message('Skipped')
}
else if (grepl(pattern = '.xlsx', x = i)) {
# Load individual document in to R as a list
temp_all <- read.xlsx(i, sheetIndex=2, header=FALSE)
temp_data <- read.xlsx(i, sheetIndex=2, startRow=6, header=FALSE)
# Extract specific cell for the name of the state
temp_bundesland <- read.xlsx(all_files[3], sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
names(temp_data) <- c('Year', 'Emissions')
temp_data$State <- paste(temp_bundesland[1,1])
# Bind individual project to main data frame
all_subbed <- rbind(all_subbed, temp_data)
}
}
export(all_subbed, file = 'Emissions_cleaned.csv')
setwd("C:\\Users\\meerim\\Desktop\\emissions")
all_files <- list.files(pattern=".xlsx")
all_subbed <- NULL
# Cleaning in a loop
for (i in all_files) {
message(i)
if (grepl(pattern = '.xls$', x = i)) {
message('Skipped')
}
else if (grepl(pattern = '.xlsx', x = i)) {
# Load individual document in to R as a list
temp_all <- read.xlsx(i, sheetIndex=2, header=FALSE)
temp_bundesland <- read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
temp_data <- read.xlsx(i, sheetIndex=2, startRow=6, header=FALSE)
# Extract specific cell for the name of the state
names(temp_data) <- c('Year', 'Emissions')
temp_data$State <- paste(temp_bundesland[1,1])
# Bind individual project to main data frame
all_subbed <- rbind(all_subbed, temp_data)
}
}
export(all_subbed, file = 'Emissions_cleaned.csv')
library(XML)
all.link <- 'http://www.ugrdl.de/tab34.htm'
Gase.table = readHTMLTable(Gase, header=T, which=1, stringsAsFactors=F)
Gase.table = readHTMLTable(all.link, header=T, which=1, stringsAsFactors=F)
URL1 <- 'http://www.ugrdl.de/tab34.htm'
table <- URL1 %>% read_html() %>%
html_nodes(xpath='//*[@id="content"]/table') %>%
html_table(fill=TRUE)  %>%
as.data.frame
library(XML)
table <- URL1 %>% read_html() %>%
html_nodes(xpath='//*[@id="content"]/table') %>%
html_table(fill=TRUE)  %>%
as.data.frame
Gase.tab;e
export(Gase.table, file = 'Gase.csv')
names(Gase.table) <- c("State", "1990", "1995", "2000", "2005", "2010", "2011", "2011*", "2012")
list.names(Gase.table)
list.Names(Gase.table)
ls(Gase.table)
export(Gase.table, file = 'Gase.csv')
list.files(pattern=".xls")
list.files(pattern=".xls$")
NRW <- read.xlsx(pattern = '.xls$', sheetIndex=2, header=FALSE)
NRW_file <- list.files(pattern=".xls$")
NRW <- read.xlsx(NRW_file, sheetIndex=2, header=FALSE)
NRW <- read.xlsx2(NRW_file, sheetIndex=2, header=FALSE)
library(rJava)
library(xlsxjars)
library(xlsx)
NRW_file <- list.files(pattern=".xls$")
NRW <- read.xlsx2(NRW_file, sheetIndex=2, header=FALSE)
all_files <- list.files()
list.files
list.files()
NRW <- read.xlsx(all_files[2], sheetIndex=2, header=FALSE)
list.files(pattern=".xls$")
read.xlsx("foederal_erneuerbar-Wirtschaft_Datenblatt.xls", sheetIndex=2)
read.xml("foederal_erneuerbar-Wirtschaft_Datenblatt.xls", sheetIndex=2)
readXML("foederal_erneuerbar-Wirtschaft_Datenblatt.xls", sheetIndex=2)
NRW <- read.csv('NRW.csv', header=FALSE)
general <- rbind('Emissions.csv', "NRW.csv")
export(general, file="General.csv")
general <- rbind(Emissions.csv, NRW.csv)
export(general, file="General.csv")
general <- rbind(all_subbed, NRW)
general <- rbind(all_subbed, NRW, by c("Year", "Emissions", "State"))
general <- merge(all_subbed, NRW, by c("Year", "Emissions", "State"))
general <- merge(all_subbed, NRW, by (c("Year", "Emissions", "State")))
general <- merge(all_subbed, NRW, by=c("Year", "Emissions", "State"))
general <- merge(all_subbed, NRW, by=("Year", "Emissions", "State"))
general <- rbind(all_subbed, NRW, by=("Year", "Emissions", "State"))
general <- rbind(all_subbed, NRW)
names(all_subbed)
names(NRW)
NRW <- read.csv('NRW.csv', header=TRUE)
names(NRW)
general <- rbind(all_subbed, NRW)
export(general, file="General.csv")
sum(general$State)
ls(general$State)
general$State
install.packages('gsubfn')
library(gsubfn)
list.files()
names(general)
general$Stata
dat <- general$State
dat
gsub("Kohlendioxid-Emissionen je Einwohner im ", "", dat)
gsub(" bis 2012", "", dat)
first <- gsub("Kohlendioxid-Emissionen je Einwohner im ", "", dat)
first
df2 <- as.data.frame(sapply(general,gsub,pattern="Kohlendioxid-Emissionen je Einwohner im ",replacement=""))
df2 <- as.data.frame(sapply(general,gsub,pattern="Kohlendioxid-Emissionen je Einwohner im ",replacement="")
(general,gsub,pattern="Kohlendioxid-Emissionen je Einwohner in ",replacement=""))
df2 <- as.data.frame(sapply(general,gsub,pattern="Kohlendioxid-Emissionen je Einwohner im " "bis",replacement=""))
df2 <- as.data.frame(sapply(general,gsub,pattern="Kohlendioxid-Emissionen je Einwohner im "|
"Kohlendioxid-Emissionen je Einwohner in ",replacement=""))
gsub (pattern="Kohlendioxid-Emissionen je Einwohner im "|
"Kohlendioxid-Emissionen je Einwohner in ",replacement="", dat)
gsub (pattern="Kohlendioxid-Emissionen je Einwohner im |
Kohlendioxid-Emissionen je Einwohner in ",replacement="", dat)
gsub (pattern="Kohlendioxid-Emissionen je Einwohner im |
Kohlendioxid-Emissionen je Einwohner in ",replacement="", dat)
gsub (pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in ",replacement="", dat)
gsub (pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012",replacement="", general$State)
export(general, file="General.csv")
Final <- gsub (pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012",replacement="", general$State)
export(Final, file="General.csv")
Final <- as.data.frame(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012",replacement="")
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012",replacement=""))
export(Final, file="Final.csv")
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012|**|*",replacement=""))
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012|*",replacement=""))
export(Final, file="Final.csv")
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012|** ",replacement=""))
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012|**",replacement=""))
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012",replacement=""))
ls(general$Year)
general$Year
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012|2011**",replacement=""))
Final2 <- as.data.frame(sapply(general$Year, gsub, pattern="**",replacement=""))
Final2 <- as.data.frame(sapply(general$Year, gsub, pattern=**,replacement=""))
Final2 <- as.data.frame(sapply(general$Year, gsub, pattern=**, replacement=""))
Final2 <- as.data.frame(sapply(general$Year, gsub, pattern='\\**', replacement=""))
Final <- as.data.frame(sapply(general, gsub, pattern="Kohlendioxid-Emissionen je Einwohner im |Kohlendioxid-Emissionen je Einwohner in | bis 2012|\\**",replacement=""))
export(Final, file="Final.csv")
match(general$State, unique(general$State))
Final <- match(general$State, unique(general$State))
Final <- as.data.frame(match(general$State, unique(general$State)))
library(rJava)
library(xlsxjars)
library(xlsx)
library(rio)        # tool for exporting to csv (can also do excel)
library(tidyr)      # tool for reshaping, though not actually done here
# 2. Setting the directory to the folder with files on the local machine
setwd("C:\\Users\\meerim\\Desktop\\emissions")
all_files <- list.files(pattern=".xlsx")
all_subbed <- NULL
for (i in all_files) {
message(i)
if (grepl(pattern = '.xls$', x = i)) {
message('Skipped')
}
else if (grepl(pattern = '.xlsx', x = i)) {
# Load individual document in to R as a list
temp_all <- read.xlsx(i, sheetIndex=2, header=FALSE)
temp_bundesland <- read.xlsx(i, sheetIndex=2, startRow=3, colIndex=2:2, endRow=3, header=FALSE)
temp_data <- read.xlsx(i, sheetIndex=2, startRow=6, header=FALSE)
# Extract specific cell for the name of the state
names(temp_data) <- c('Year', 'Emissions')
temp_data$State <- paste(temp_bundesland[1,1])
# Bind individual project to main data frame
all_subbed <- rbind(all_subbed, temp_data)
}
}
export(all_subbed, file = 'Emissions_cleaned.csv')
source('~/GitHub/Climate-Happiness/Data/Emissions.R', echo=TRUE)
install.packages("gsubfn")
setwd("C:\\Users\\meerim\\Documents\\GitHub\\Climate-Happiness\\emissions")
sum(Final$Emissions)
mean(Final$Emissions)
attach Final
attach(Final)
mean(Emissions)
dm(Emissions)
list(Final)
